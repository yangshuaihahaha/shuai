function markAlertRead(e,t){DWRAlertService.markAlertRead(t,null);var n=e.parentNode;n.style.display="none";var r=document.getElementById("unreadAlertSize"),i=parseInt(r.innerHTML);return i==1?(n=n.parentNode.parentNode,n.style.display="none"):(i-=1,r.innerHTML=i),!1}function markAllAlertsRead(e){DWRAlertService.markAllAlertsRead();var t=e.parentNode;t=t.parentNode,t.style.display="none"}function addClass(e,t){e.className.indexOf(t)==-1&&(e.className=t+" "+e.className)}function removeClass(e,t){var n=e.className,r=n.indexOf(t);if(r!=-1){var i=e.className.indexOf(" ",r);i==-1&&(i=n.length),e.className=n.substring(0,r,i)+" "+n.substring(i,n.length)}}function hasClass(e,t){var n=e.className.split(" ");for(var r=0;r<n.length;r++)if(n[r]==t)return!0;return!1}function showDiv(e){var t=document.getElementById(e);t&&(t.style.display="")}function hideDiv(e){var t=document.getElementById(e);t&&(t.style.display="none")}function importJavascriptFile(e){var t=document.getElementsByTagName("script"),n=!1;for(var r=0;r<t.length&&!n;r++){var i=t[r].src,s=i.indexOf("?");s!=-1&&(i=i.substring(0,s)),i.length>=e.length&&i.indexOf(e)==i.length-e.length&&(n=!0)}if(!n){var o=document.getElementsByTagName("head").item(0);script=document.createElement("script"),script.src=e,script.type="text/javascript",o.appendChild(script)}}function parseSimpleDate(e,t){if(e==null||e.length!=10)return null;var n=t.substr(0,1).toLowerCase(),r,i,s;n=="m"?(r=e.substr(6,4),i=e.substr(0,2),s=e.substr(3,2)):n=="y"?(r=e.substr(0,4),i=e.substr(3,2),s=e.substr(8,2)):(r=e.substr(6,4),i=e.substr(3,2),s=e.substr(0,2));var o=new Date;return o.setYear(r),o.setMonth(i-1),o.setDate(s),o}function parseDateFromStringToJs(e,t){if(t==null)return new Date;var n,r=new Date;return(n=e.search(/mm/))!=-1&&r.setMonth(t.substring(n,n+2)-1),(n=e.search(/dd/))!=-1&&r.setDate(t.substring(n,n+2)),(n=e.search(/yyyy/))!=-1&&r.setYear(t.substring(n,n+4)),r}function tenrule(e){return(e<10?"0":"")+e}function parseDateFromJsToString(e,t){return t==null&&(t=new Date),e.replace(/mm/,tenrule(t.getMonth()+1)).replace(/dd/,tenrule(t.getDate())).replace(/yyyy/,t.getFullYear()?t.getFullYear():1900+t.getYear())}function escapeJquerySelector(e){return e.replace(/#/g,"\\#").replace(/;/g,"\\;").replace(/&/g,"\\&").replace(/,/g,"\\,").replace(/\./g,"\\.").replace(/\+/g,"\\+").replace(/\*/g,"\\*").replace(/~/g,"\\~").replace(/'/g,"\\'").replace(/:/g,"\\:").replace(/"/g,'\\"').replace(/!/g,"\\!").replace(/\^/g,"\\^").replace(/\$/g,"\\$").replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/=/g,"\\=").replace(/>/g,"\\>").replace("/|/g","\\|").replace(/\//,"\\/").replace(/@/g,"\\@")}function jquerySelectEscaped(e){return $("#"+escapeJquerySelector(e))}function DatePicker(e,t,n){var r;typeof t=="string"?(t=escapeJquerySelector(t),r=jQuery("#"+t)):r=jQuery(t),n==null&&(n={}),setOptions(n,"dateFormat",e.replace("yyyy","yy")),setOptions(n,"appendText","("+e+")"),setOptions(n,"gotoCurrent",!0),setOptions(n,"changeMonth",!0),setOptions(n,"changeYear",!0),setOptions(n,"showOtherMonths",!0),setOptions(n,"selectOtherMonths",!0),r.datepicker(n),this.setDate=function(t){var n=t;typeof t=="string"&&(n=parseDateFromStringToJs(e,t)),r.datepicker("setDate",n)},this.getDate=function(){return r.datepicker("getDate")},this.getDateAsString=function(){return parseDateFromJsToString(e,this.getDate())},this.show=function(){r.datepicker("show")}}function DateTimePicker(e,t,n,r){var i;typeof n=="string"?(n=escapeJquerySelector(n),i=jQuery("#"+n)):i=jQuery(n),r==null&&(r={}),setOptions(r,"dateFormat",e.replace("yyyy","yy")),setOptions(r,"timeFormat",t),setOptions(r,"separator"," "),t.search(/t/i)!=-1&&setOptions(r,"ampm",!0),setOptions(r,"appendText","("+e+r.separator+t+")"),setOptions(r,"gotoCurrent",!0),setOptions(r,"changeMonth",!0),setOptions(r,"changeYear",!0),setOptions(r,"showOtherMonths",!0),setOptions(r,"selectOtherMonths",!0),i.datetimepicker(r),this.show=function(){i.datetimepicker("show")}}function TimePicker(e,t,n){var r;typeof t=="string"?(t=escapeJquerySelector(t),r=jQuery("#"+t)):r=jQuery(t),n==null&&(n={}),setOptions(n,"timeFormat",e),e.search(/t/i)!=-1&&setOptions(n,"ampm",!0),setOptions(n,"appendText","("+e+")"),setOptions(n,"gotoCurrent",!0),setOptions(n,"changeMonth",!0),setOptions(n,"changeYear",!0),setOptions(n,"showOtherMonths",!0),setOptions(n,"selectOtherMonths",!0),r.timepicker(n),this.show=function(){r.timepicker("show")}}function AutoComplete(e,t,n){var r;typeof e=="string"?(e=escapeJquerySelector(e),r=jQuery("#"+e)):r=jQuery(e),n==null&&(n={}),setOptions(n,"minLength",2),setOptions(n,"delay",0),setOptions(n,"source",function(e,n){t(e.term,n)}),r.autocomplete(n);if(n.placeholder){var i=n.placeholder.toString().replace(/(\r\n|\n|\r)/gm,"");r.attr("placeholder",i)}}function setOptions(e,t,n){if(e[t])return;e[t]=n}function colorVisibleTableRows(e,t,n,r){var i=jQuery("#"+e+" tr"),s=!0;for(var o=r?0:1;o<i.length;o++){if(!jQuery(i[o]).is(":visible"))continue;jQuery(i[o]).css("backgroundColor",s?t:n),s=!s}}function maxLength(e,t){e.value.length>=t&&(e.value=e.value.substring(0,t))}function removeNode(e){e.parentNode.removeChild(e)}function addAutoComplete(e,t,n,r,i,s){new AutoComplete(e,n,{select:function(e,n){jquerySelectEscaped(t).val(n.item.object[r]),n.item.object&&s&&s(n.item.object)},placeholder:i})}function showError(e){document.getElementById(e).style.display=""}function hideError(e){document.getElementById(e).style.display="none"}function forceMaxLength(e,t){e.value.length>=t&&(e.value=e.value.substring(0,t))}function sanitizeHtml(e){return html_sanitize(e)}function CreateCallback(e){function n(e,t){var n=e.split(" ");for(var r=0;r<n.length;r++)if(jQuery.trim(n[r]).length>0){var i=" "+n[r];e=e.replace(i,function(e){return"{{{{"+e+"}}}}"},"gi")}return e=e.replace(/{{{{/g,""),e=e.replace(/}}}}/g,""),e}e==null&&(e={});var t=e.maxresults;t==null&&(t=50),this.searchCounter=0,this.conceptCallback=function(){var t=this;return function(n,r){if(jQuery.trim(n).length==0)return r(!1);var i=jQuery.makeArray(e.includeClasses),s=jQuery.makeArray(e.excludeClasses),o=jQuery.makeArray(e.includeDatatypes),u=jQuery.makeArray(e.excludeDatatypes);t.searchCounter+=1,$.ajax({type:"get",url:"fieldgen/itemlist.page",dataType:"json",data:{phrase:n,includeRetired:!1,includeClassNames:i.join(","),excludeClassNames:s.join(","),includeDatatypeNames:o.join(","),excludeDatatypeNames:u.join(",")},success:function(e){t.makeRows(e,r,t.searchCounter,t.displayNamedObject)},error:function(e){alert("errmsg")}})}},this.displayConceptReferenceTerm=function(e){return function(t){if(typeof t=="string")return{label:t,value:""};var r=" "+t.code+(t.name!=null&&$j.trim(t.name)!=""?" - "+t.name:"")+" ["+t.conceptSourceName+"]";r=n(r,e);var i=t.code;return r="<span class='autocompleteresult'>"+r+"</span>",{label:r,value:i,object:t}}},this.makeRows=function(e,n,r,i){var s=this;if(r<this.searchCounter)return;this.searchCounter=r;if(t>0&&t<e.length){var o=e.length-t;e=e.slice(0,t),e.push("("+o+" "+omsgs.resultsNotDisplayed+")")}var u=jQuery.map(e,i(e));n(u)},this.displayNamedObject=function(e){return function(t){if(typeof t=="string")return{label:t,value:""};var r=" "+t.name;r=n(r,e);var i=t.name;return{label:r,value:i,object:t}}},this.conceptAnswersCallback=function(){var t=this;return function(n,r){t.searchCounter+=1,$.ajax({type:"post",url:"fieldgen/findconceptanswers.page",dataType:"json",data:{text:n,conceptId:e.showAnswersFor,includeVoided:!1,includeDrugConcepts:!1},success:function(e){t.makeRows(e,r,t.searchCounter,t.displayNamedObject)},error:function(e){alert("errmsg")}})}}}function radioDown(e){tempRadioStatus=e.checked}function radioClicked(e){tempRadioStatus&&(e.checked=!1)}function showError(e,t){var n=document.getElementById(e);n==null?window.alert("Error: "+t+"\n\n(Cannot find div: "+e+")"):(n.innerHTML!=""?n.innerHTML+=", "+t:n.innerHTML=t,showDiv(e))}function clearError(e){hideDiv(e);var t=document.getElementById(e);t!=null&&(t.innerHTML="")}function checkNumber(e,t,n,r,i,s){if($(e).attr("data-field-invalid")=="true"){addIllegalStyle($(e));return}clearError(t);var o=verifyNumber(e,n,r,i,s);e.value==""&&(e.className=null),o==null?(addLegalStyle($(e)),clearError(t)):(addIllegalStyle($(e)),showError(t,o))}function addIllegalStyle(e){e.toggleClass("illegalValue"),e.removeClass("legalValue"),e.attr("class")==""&&e.addClass("illegalValue")}function addLegalStyle(e){e.toggleClass("legalValue"),e.removeClass("illegalValue"),e.attr("class")==""&&e.addClass("legalValue")}function verifyNumber(e,t,n,r,i){i||(defaultErrorMessages?i=defaultErrorMessages:i={notANumber:"Not a number",notAnInteger:"Not an integer",notLessThan:"Cannot be less than",notGreaterThan:"Cannot be greater than"});var s=e.value.trim();if(s=="")return null;if(t){if(!/^[+-]?\d*(.\d+)?$/.test(s))return i.notANumber;s=parseFloat(s)}else{if(!/^[+-]?\d+$/.test(s))return i.notAnInteger;s=parseInt(s)}return n!=null&&n>s?i.notLessThan+" "+n:r!=null&&s>r?i.notGreaterThan+" "+r:null}function getElementsByClass(e,t){var n=new Array,r=e.getElementsByTagName("*");for(var i=0;i<r.length;++i)r[i].className==t&&n.push(r[i]);return n}function findParentWithClass(e,t){var n=e.parentNode;while(n!=null&&n.className!=t)n=n.parentNode;return n}function showAnotherRow(e){var t="repeating_table_"+e,n=getElementsByClass(document,t);for(var r=0;r<n.length;++r)if(n[r].style.display=="none"){n[r].style.display="";var i=getElementsByClass(n[r],"visibleFlag");i.length>0&&(i[0].value="true");return}}function removeRow(e,t){var n="repeating_table_"+e,r=findParentWithClass(t,n);if(r){r.style.display="none";var i=getElementsByClass(r,"visibleFlag");i.length>0&&(i[0].value="false")}}function getContextPath(){var e=typeof OPENMRS_CONTEXT_PATH=="undefined"?openmrsContextPath:OPENMRS_CONTEXT_PATH;return e.charAt(0)!="/"&&(e="/"+e),e}function setupAutocomplete(e,t,n,r){var i=$("#"+e.id+"_hid"),s=$(e),o=!1;i.length>0&&s.length>0&&s.autocomplete({source:function(e,s){$.getJSON(location.protocol+"//"+location.host+getContextPath()+"/"+t+"?answerids="+n+"&answerclasses="+r,e,function(e){var t=[];$.each(e,function(e,n){t.push(n)}),t.length==0&&i.val(""),s(t)})},minLength:2,select:function(e,t){i.val(t.item.id),o=!0},close:function(e,t){o?(s.css("color","green"),s.trigger("change")):(s.css("color","red"),i.val("ERROR")),o=!1}})}function setupSelect2(e,t,n,r,i,s){function a(e){if(e.loading)return e.text;var t="<div>"+e.name+"</div>";return t}function f(e){var t=u.attr("id")+"_hid";return e.id?$("#"+t+"").val(e.id):$("#"+t+"").val(""),e.name==undefined?e.text:e.name}var o="en";typeof lang!="undefined"&&(o=lang),o=="zh"&&(o="zh-CN");var u=$(e);s!=undefined&&s!=null&&u.append("<option value='"+s+"'>"+i+"</option>"),$.fn.select2.defaults.set("theme","bootstrap"),u.select2({width:"off",ajax:{url:""+t+"",type:"POST",dataType:"json",delay:250,data:function(e){return{term:e.term,answerids:n,answerclasses:r}},processResults:function(e,t){return{results:e.items}},cache:!0},escapeMarkup:function(e){return e},placeholder:"&nbsp;",allowClear:!0,minimumInputLength:2,templateResult:a,templateSelection:f,language:o}),s!=undefined&&s!=null&&u.val([""+s+""]).trigger("change")}function onBlurAutocomplete(e){var t=$("#"+e.id+"_hid"),n=$(e);if(t.val()==""||t.val()=="ERROR")n.val()!=""?(t.val("ERROR"),n.css("color","red")):n.val()==""&&t.val("")}function setupOptionAutocomplete(e,t,n){var r=$("#"+e.id+"_hid"),i=$(e),s=!1,o=t.split(","),u=n.split(","),a=new Object;for(var f=0;f<o.length;f++)a[o[f]]=u[f];i.autocomplete({source:o,minLength:2,select:function(e,t){r.val(a[t.item.value]),s=!0},close:function(e,t){s?(i.css("color","green"),i.trigger("change")):(i.css("color","red"),r.val("ERROR")),s=!1}})}function setValWhenAutocompleteFieldBlanked(e){var t=$(e),n=$("#"+e.id+"_hid");t.val()===""&&n.val("")}function setValueByName(e,t,n){t==null&&(t=""),n==null&&(n={});var r=e,i=document.getElementsByName(r);i.length>=1&&(e=i.item(0));if(e==null){window.alert("setValueByName() can't find an element with name: "+r+".");return}dwr.util.highlight(e,n);if(dwr.util._isHTMLElement(e,"select")){e.type=="select-multiple"&&dwr.util._isArray(t)?dwr.util._selectListItems(e,t):dwr.util._selectListItem(e,t);return}if(dwr.util._isHTMLElement(e,"input")){if(e.type=="radio"||e.type=="checkbox")if(i&&i.length>=1)for(var s=0;s<i.length;s++){var o=i.item(s);if(o.type!=e.type)continue;if(dwr.util._isArray(t)){o.checked=!1;for(var u=0;u<t.length;u++)t[u]==o.value&&(o.checked=!0)}else o.checked=o.value==t}else e.checked=t==1;else setDatePickerValue("#"+r+"-display",t),e.value=t;return}if(dwr.util._isHTMLElement(e,"textarea")){e.value=t;return}if(t.nodeType){t.nodeType==9&&(t=t.documentElement),t=dwr.util._importNode(e.ownerDocument,t,!0),e.appendChild(t);return}dwr.util._shouldEscapeHtml(n)&&typeof t=="string"?e.textContent?e.textContent=t:e.innerText?e.innerText=t:e.innerHTML=dwr.util.escapeHtml(t):e.innerHTML=t}function getField(e){var t=propertyAccessorInfo[e];if(t){var n=t.id,r=t.field;r==null&&(r=defaultFieldFunction);var i=r(n);return i}return null}function getValue(e){var t=propertyAccessorInfo[e];if(t){var n=t.id,r=t.getter;return r==null&&(r=defaultGetterFunction),r(n)}return null}function setValue(e,t){var n=propertyAccessorInfo[e];if(n){var r=n.id,i=n.setter;return i==null&&(i=defaultSetterFunction),i(r,t)}window.alert("Form scripting error: no property accesser info available for "+e)}function defaultFieldFunction(e){var t=$("#"+e);return t.length>0?t:$("input:radio[name='"+e+"']")}function defaultGetterFunction(e){return DWRUtil.getValue(e)}function defaultSetterFunction(e,t){if(e==null||document.getElementById(e)==null){window.alert("Form scripting error: cannot find widget "+e);return}DWRUtil.setValue(e,t)}function checkboxGetterFunction(e){var t=DWRUtil.getValue(e);return t?$("#"+e).val():null}function checkboxSetterFunction(e,t){if(e==null||document.getElementById(e)==null){window.alert("Form scripting error: cannot find widget "+e);return}var n=$("#"+e).val();DWRUtil.setValue(e,t==1||t==n)}function dateFieldGetterFunction(e){return $("#"+e+"-display")}function dateSetterFunction(e,t){setDatePickerValue("#"+e+"-display",t)}function newRelationshipFieldGetterFunction(e){return document.getElementById(e+"name").value}function autocompleteSetterFunction(e,t){if(e==null||document.getElementById(e)==null){window.alert("Form scripting error: cannot find widget "+e);return}DWRUtil.setValue(e+"_hid",t)}function autocompleteGetterFunction(e){return $("#"+e+"_hid").val()}function existingEncounterOnDate(e,t){if(t!="block"&&t!="warn")return;var n=$(e).val(),r=$("[name=htmlFormId]").val(),i=$("[name=personId]").val();$("[name=encounterId]").val()==null&&$.get("lastEnteredForm.form",{formId:r,patientId:i,date:n},function(n){n=="true"&&(t=="warn"?$.get("localizedMessage.form",{messageCode:"htmlformentry.error.warnMultipleEncounterOnDate"},function(e){alert(e)}):t=="block"&&($.get("localizedMessage.form",{messageCode:"htmlformentry.error.blockMultipleEncounterOnDate"},function(e){alert(e)}),$(e).val("")))})}function setupDatePicker(e,t,n,r,i,s,o,u,a){$.fn.datepicker.dates[r]||setupDatePickerLocalization(r),t.indexOf("yyyy")<0&&(t=t.replace("yy","yyyy")),e.indexOf("yyyy")<0&&(e=e.replace("yy","yyyy"));var f=n.split(","),l=new Date,c=moment().year(l.getFullYear()-parseInt(f[0])).toDate(),h=moment().year(l.getFullYear()+parseInt(f[1])).toDate(),p=$(i);o=o===undefined?0:isNaN(o)?o:parseInt(o);var d=o>0||isNaN(o)&&o!=="days";d?p.datepicker({autoclose:!0,startDate:c,endDate:h,format:{toDisplay:function(n){return $(s).val(moment(n).format(t.toUpperCase())),moment(n).format(e.toUpperCase())},toValue:function(e){return moment(e,t.toUpperCase()).toDate()}},minViewMode:o}):p.datepicker({autoclose:!0,startDate:c,endDate:h,format:e}),r&&$.fn.datepicker.dates[r]&&p.datepicker("option",$.fn.datepicker.dates[r]),u&&setDatePickerValue(i,s,u),p.on("changeDate",function(){$(s).val($(i).val())})}function setDatePickerValue(e,t,n){try{n!=null?($(e).datepicker("setDate",n),$(t).val(n)):($(e).datepicker("setDate",null),$(t).val(null))}catch(r){}}function setupDatePickerLocalization(e){e=="en"||e=="en-US"||e=="en-GB"?$.fn.datepicker.dates["en-GB"]={days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}:e=="es"?$.fn.datepicker.dates.es={days:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],daysShort:["Dom","Lun","Mar","Mié","Juv","Vie","Sáb"],daysMin:["Do","Lu","Ma","Mi","Ju","Vi","Sá"],months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthsShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],today:"Hoy",clear:"Claro"}:e=="fr"?$.fn.datepicker.dates.fr={days:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],daysShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],daysMin:["Di","Lu","Ma","Me","Je","Ve","Sa"],months:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],monthsShort:["Jan","Fév","Mar","Avr","Mai","Jun","Jul","Aoû","Sep","Oct","Nov","Déc"],today:"Aujourd'hui",clear:"Clear"}:e=="it"?$.fn.datepicker.dates.it={days:["Domenica","Lunedì","Martedì","Mercoledì","Giovedì","Venerdì","Sabato"],daysShort:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],daysMin:["Do","Lu","Ma","Me","Gi","Ve","Sa"],months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],monthsShort:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],today:"Oggi",clear:"Clear"}:e=="pt"?$.fn.datepicker.dates.pt={days:["Domingo","Segunda-feira","Terça-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sabado"],daysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"],daysMin:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"],months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],today:"Hoje",clear:"Clear"}:e=="zh_CN"&&($.fn.datepicker.dates.zh_CN={days:["周日","周一","周二","周三","周四","周五","周六"],daysShort:["日","一","二","三","四","五","六"],daysMin:["日","一","二","三","四","五","六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthsShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],today:"今天",clear:"清除"})}useLoadingMessage=function(e){var t;e?t=e:t=dwrLoadingMessage,dwr.engine.setPreHook(function(){var e=document.getElementById("disabledZone");if(!e){e=document.createElement("div"),e.setAttribute("id","disabledZone"),document.body.appendChild(e);var n=document.createElement("div");n.setAttribute("id","messageZone"),e.appendChild(n);var r=document.createTextNode(t);n.appendChild(r)}else document.getElementById("messageZone").innerHTML=t,e.style.display=""}),dwr.engine.setPostHook(function(){document.getElementById("disabledZone").style.display="none"})};var tempRadioStatus;openmrs=document.openmrs||{},openmrs.htmlformentry=openmrs.htmlformentry||{},openmrs.htmlformentry.duplicateTemplate=function(e){if(mode&&mode=="VIEW")return;var t=$(e),n=t.attr("data-dynamic-repeat-grouping-id"),r=$("#htmlform script[data-dynamic-repeat-grouping-id="+n+"]"),i=r.attr("data-dynamic-repeat-counter-name"),s=$("#htmlform input#"+i),o=r.parent();r.length>0&&o.append(r.html());var u=s.val()===""||s.val()===undefined?"0":s.val(),a=o.children(),f=$(a.get(a.length-1));f.find("input, textarea, select, .field-error").each(function(){if($(this).attr("id")){var e=$(this).attr("id").split("-template",2);$(this).attr("id",e[0]+"-"+u+e[1]),$(this).attr("data-field-display-name")&&$(this).attr("data-field-name")&&($(this).attr("data-field-display-name","#"+$(this).attr("id")),$(this).attr("data-field-name","#"+$(this).attr("id").replace("-display","")))}if($(this).attr("onblur")){var t=$j(this).attr("onblur").split("-template",2);$(this).attr("onblur",t[0]+"-"+u+t[1])}if($(this).attr("name")){var n=$j(this).attr("name").split("-template",2);$(this).attr("name",n[0]+"-"+u+n[1])}}),f.children().each(function(){$(this).attr("value")&&$(this).attr("type")!="button"&&$(this).attr("value","")}),renderCustomizedFormComponents&&renderCustomizedFormComponents(f),s.val(++u),o.find('.dynamic-repeat-row-sort-weight > input[type="text"]').each(function(e){$(this).val(e+1)}),f.find("[rel=popover]").popover({html:!0,placement:"right",trigger:"hover",content:function(){return $($(this).data("contentwrapper")).html()}})},openmrs.htmlformentry.removeFunction=function(e){if(mode&&mode=="VIEW")return;var t=$(e),n=t.attr("data-dynamic-repeat-grouping-id"),r=$("#htmlform script[data-dynamic-repeat-grouping-id="+n+"]"),i=r.attr("data-dynamic-repeat-counter-name"),s=$("#htmlform input#"+i),o=r.parent(),u=t.parent();while(!u.hasClass("dynamic-repeat-row"))u=u.parent();u.remove();debugger;s.val(o.find(".dynamic-repeat-row").length),o.find('.dynamic-repeat-row-sort-weight > input[type="text"]').each(function(e){$(this).val(e+1)})},openmrs.htmlformentry.refresh=function(e){var t=!0,n=e.split("span",1)+"_hid",r=e.split("span",1)+"_div",i=e.split("span",1)+"span_";$("#"+r+" span").each(function(e){$("#"+r).data("count",e+1),$("#"+n).attr("value",$("#"+r).data("count")),t=!1;var i=this.id,s=i.split("_",1)+"_"+e;this.id=s,$("#"+i+"_hid").attr("id",s+"_hid"),$("#"+i+"_button").removeAttr("onclick",null).unbind("click").attr("id",s+"_button").click(function(){$("#"+s).remove(),openmrs.htmlformentry.refresh(s+"_button")}),$("#"+s+"_hid").attr("name",s+"_hid")}),t&&$("#"+r).data("count",0),$("#"+n).attr("value",$("#"+r).data("count"))},function(htmlForm,$,undefined){var onObsChangedCheck=function(){var whenValueThenDisplaySection=$(this).data("whenValueThenDisplaySection");if(whenValueThenDisplaySection){var val=$(this).val();$.each(whenValueThenDisplaySection,function(e,t){val==e?$(t).show():($(t).hide(),$(t).find("input:hidden, input:text, input:password, input:file, select, textarea").val(""),$(t).find("input:checkbox, input:radio").removeAttr("checked").removeAttr("selected"))})}var whenValueThenJs=$(this).data("whenValueThenJs");if(whenValueThenJs){var val=$(this).val();$.each(whenValueThenJs,function(ifValue,thenJs){val==ifValue&&eval(thenJs)})}var whenValueElseJs=$(this).data("whenValueElseJs");if(whenValueElseJs){var val=$(this).val();$.each(whenValueElseJs,function(ifValue,elseJs){val!=ifValue&&eval(elseJs)})}};htmlForm.setupWhenThen=function(e,t,n,r){var i=getField(e+".value");i.data("whenValueThenDisplaySection",t),i.data("whenValueThenJs",n),i.data("whenValueElseJs",r),i.change(onObsChangedCheck).change()},htmlForm.compileMustacheTemplate=function(e){return Handlebars.compile(e)}}(window.htmlForm=window.htmlForm||{},jQuery)